#include "JoystickDriver.h"

const int lowDeadzone = -5;
const int highDeadzone = 5;
int max;

void initializeRobot(){
  // left motor is motor 1
  // right motor is motor 2
}

void turnLeft(int magnitude){
  if (magnitude == -128) { magnitude++ ; }
  
  magnitude = magnitude * (100 / 127);
  
  motor[motorA] = magnitude;
  motor[motorB] = max;
}

void turnRight(int magnitude){
  magnitude = magnitude * (100 / 127);
  
  motor[motorB] = magnitude;
  motor[motorA] = max;
}

void goStraight(){
  motor[motorB] = max;
  motor[motorA] = max;
}

void setMaxFromJoystick(int magnitude){
  if (magnitude == -128) { magnitude++; }
  
  magnitude = magnitude * (100 / 127);
  
  max = magnitude;
}

task main(){
  initializeRobot();
  waitForStart();
  
  while (true){
    leftStick = joystick.joy1_x1;
    rightStick = joystick.joy1_y2;	
  
    if (rightStick < lowDeadzone && rightStick > highDeadzone){
      setMaxFromJoystick(rightStick);
    }
    else if (joy1Btn(6)){
      max = 100;
    }
    else if (joy1Btn(5){
      max = -100;
    }
  	
    if (leftStick < lowDeadzone){
      turnLeft(leftStick);
    }
    else if (leftStick > highDeadzone){
      turnRight(leftStick);
    }
	else{
	  goStraight();
	}
  }
}